@if (isLoading) {<app-loading-spinner></app-loading-spinner>}

<div class="bg-surface-light dark:bg-surface-dark border-b border-border-light dark:border-border-dark py-3">
  <div class="container mx-auto px-4 text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2">
    <a href="/" class="hover:text-primary transition-colors"><span
        class="material-icons text-sm align-text-bottom">home</span></a>
    <span class="text-gray-400 dark:text-gray-600">/</span>
    <span class="text-gray-800 dark:text-gray-200 font-medium">Catálogo</span>
  </div>
</div>

<main class="container mx-auto px-4 py-8 flex-1">
  <div class="flex flex-col lg:flex-row gap-8">
    <aside class="w-full lg:w-1/4 flex-shrink-0 space-y-6">
      <!-- Categories -->
      <div
        class="bg-surface-light dark:bg-surface-dark p-5 rounded border border-border-light dark:border-border-dark shadow-sm">
        <h3
          class="font-display text-xl font-bold uppercase mb-4 text-gray-800 dark:text-white border-l-4 border-primary pl-2">
          Categorías</h3>
        <div class="space-y-2 text-sm text-gray-600 dark:text-gray-300">
          <label class="flex items-center gap-3 cursor-pointer group">
            <input
              class="form-checkbox text-primary rounded border-gray-400 dark:border-gray-600 bg-transparent focus:ring-primary focus:ring-offset-0"
              type="checkbox" value="Pastillas y bandas" (click)="getCategoriesFilters($event)" />
            <span class="group-hover:text-primary transition-colors">Pastillas y bandas</span>
          </label>
          <label class="flex items-center gap-3 cursor-pointer group">
            <input
              class="form-checkbox text-primary rounded border-gray-400 dark:border-gray-600 bg-transparent focus:ring-primary focus:ring-offset-0"
              type="checkbox" value="Kit de arrastre" (click)="getCategoriesFilters($event)" />
            <span class="group-hover:text-primary transition-colors">Kit de arrastre</span>
          </label>
          <label class="flex items-center gap-3 cursor-pointer group">
            <input
              class="form-checkbox text-primary rounded border-gray-400 dark:border-gray-600 bg-transparent focus:ring-primary focus:ring-offset-0"
              type="checkbox" value="Carenajes farolas y guardabarros" (click)="getCategoriesFilters($event)" />
            <span class="group-hover:text-primary transition-colors">Carenajes farolas y guardabarros</span>
          </label>
          <label class="flex items-center gap-3 cursor-pointer group">
            <input
              class="form-checkbox text-primary rounded border-gray-400 dark:border-gray-600 bg-transparent focus:ring-primary focus:ring-offset-0"
              type="checkbox" value="Tornillería especial" (click)="getCategoriesFilters($event)" />
            <span class="group-hover:text-primary transition-colors">Tornillería especial</span>
          </label>
          <label class="flex items-center gap-3 cursor-pointer group">
            <input
              class="form-checkbox text-primary rounded border-gray-400 dark:border-gray-600 bg-transparent focus:ring-primary focus:ring-offset-0"
              type="checkbox" value="Aceites y lubricantes" (click)="getCategoriesFilters($event)" />
            <span class="group-hover:text-primary transition-colors">Aceites y lubricantes</span>
          </label>
          <label class="flex items-center gap-3 cursor-pointer group">
            <input
              class="form-checkbox text-primary rounded border-gray-400 dark:border-gray-600 bg-transparent focus:ring-primary focus:ring-offset-0"
              type="checkbox" value="Partes eléctricas" (click)="getCategoriesFilters($event)" />
            <span class="group-hover:text-primary transition-colors">Partes eléctricas</span>
          </label>
        </div>
      </div>

      <!-- Marcas -->
      <div
        class="bg-surface-light dark:bg-surface-dark p-5 rounded border border-border-light dark:border-border-dark shadow-sm">
        <h3
          class="font-display text-xl font-bold uppercase mb-4 text-gray-800 dark:text-white border-l-4 border-primary pl-2">
          Marcas</h3>
        <select (change)="getBrandsFilters($event.target)"
          class="w-full bg-background-light dark:bg-background-dark border border-gray-300 dark:border-gray-600 rounded py-2 px-3 text-sm focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary text-gray-700 dark:text-gray-300">
          <option value="">Seleccionar marca...</option>
          @for (brand of listMarca; track brand) {
          <option [value]="brand.name">{{brand.name}}</option>
          }
        </select>
      </div>

      <!-- Precio -->
      <div
        class="bg-surface-light dark:bg-surface-dark p-5 rounded border border-border-light dark:border-border-dark shadow-sm">
        <h3
          class="font-display text-xl font-bold uppercase mb-4 text-gray-800 dark:text-white border-l-4 border-primary pl-2">
          Precio</h3>
        <div class="flex items-center gap-2">
          <input (input)="getMinPriceFilter($event)"
            class="w-full bg-background-light dark:bg-background-dark border border-gray-300 dark:border-gray-600 rounded py-2 px-3 text-sm focus:outline-none focus:border-primary text-gray-700 dark:text-gray-300"
            placeholder="Min" type="number" />
          <span class="text-gray-400">-</span>
          <input (input)="getMaxPriceFilter($event)"
            class="w-full bg-background-light dark:bg-background-dark border border-gray-300 dark:border-gray-600 rounded py-2 px-3 text-sm focus:outline-none focus:border-primary text-gray-700 dark:text-gray-300"
            placeholder="Max" type="number" />
        </div>
      </div>

      <!-- Vehículo -->
      <div
        class="bg-surface-light dark:bg-surface-dark p-5 rounded border border-border-light dark:border-border-dark shadow-sm">
        <h3
          class="font-display text-xl font-bold uppercase mb-4 text-gray-800 dark:text-white border-l-4 border-primary pl-2">
          Vehículo</h3>
        <div class="space-y-3">
          <select (change)="getMarcaFilters($event.target)"
            class="w-full bg-background-light dark:bg-background-dark border border-gray-300 dark:border-gray-600 rounded py-2 px-3 text-sm focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary text-gray-700 dark:text-gray-300">
            <option value="">Marca Vehículo</option>
            @for (brand of list; track brand) {
            <option [value]="brand.name">{{brand.name}}</option>
            }
          </select>
          <select (change)="getSizeFilters($event.target)"
            class="w-full bg-background-light dark:bg-background-dark border border-gray-300 dark:border-gray-600 rounded py-2 px-3 text-sm focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary text-gray-700 dark:text-gray-300">
            <option value="">Referencia Vehículo</option>
            @for (ref of listReferencias; track ref) {
            <option [value]="ref.name">{{ref.name}}</option>
            }
          </select>
        </div>
      </div>
    </aside>

    <section class="flex-1">
      <!-- Sort and Toggle View -->
      <div
        class="flex flex-wrap items-center justify-between mb-6 gap-4 bg-surface-light dark:bg-surface-dark p-4 rounded border border-border-light dark:border-border-dark">
        <div class="flex items-center gap-2">
          <label class="text-sm font-medium text-gray-600 dark:text-gray-400">Ordenar por:</label>
          <select (change)="getSort($any($event.target).value)"
            class="bg-transparent border-none text-sm font-bold text-gray-800 dark:text-white focus:ring-0 cursor-pointer outline-none">
            <option value="Asc">Nombre(A-Z)</option>
            <option value="Des">Nombre(Z-A)</option>
          </select>
        </div>
        <div class="flex items-center gap-2">
          <button class="p-2 text-white bg-primary rounded shadow-md hover:bg-primary-dark transition-colors">
            <span class="material-icons text-lg">grid_view</span>
          </button>
          <button
            class="p-2 text-gray-500 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors">
            <span class="material-icons text-lg">view_list</span>
          </button>
        </div>
      </div>

      <!-- Product Grid -->
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        @for (product of obs | async; track product._id) {
        <app-product-card [product]="product" class="h-full block"></app-product-card>
        }
      </div>

      <!-- Pagination -->
      <div class="mt-8">
        <mat-paginator #paginator [pageSize]="15" [pageSizeOptions]="[6, 15, 30, 60]" aria-label="Select page"
          class="bg-surface-light dark:bg-surface-dark text-gray-800 dark:text-gray-200 rounded border border-border-light dark:border-border-dark">
        </mat-paginator>
      </div>

    </section>
  </div>
</main>